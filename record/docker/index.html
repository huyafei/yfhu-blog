<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Docker | vensst</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/yfhu-blog/static/images/logo.png">
    <script src="https://unpkg.com/@vensst/js-toolkit"></script>
    <meta name="description" content="为开发者提供搭建项目模板脚手架、ui组件库、js工具库">
    
    <link rel="preload" href="/yfhu-blog/assets/css/0.styles.57c53af5.css" as="style"><link rel="preload" href="/yfhu-blog/assets/js/app.cc026d7f.js" as="script"><link rel="preload" href="/yfhu-blog/assets/js/2.c664984a.js" as="script"><link rel="preload" href="/yfhu-blog/assets/js/1.e3116851.js" as="script"><link rel="preload" href="/yfhu-blog/assets/js/57.c914399e.js" as="script"><link rel="prefetch" href="/yfhu-blog/assets/js/10.0c7f0f23.js"><link rel="prefetch" href="/yfhu-blog/assets/js/100.7a187dd9.js"><link rel="prefetch" href="/yfhu-blog/assets/js/101.11d3ae70.js"><link rel="prefetch" href="/yfhu-blog/assets/js/102.fddcec7d.js"><link rel="prefetch" href="/yfhu-blog/assets/js/103.edbf0294.js"><link rel="prefetch" href="/yfhu-blog/assets/js/104.102cf767.js"><link rel="prefetch" href="/yfhu-blog/assets/js/105.b3eb64bf.js"><link rel="prefetch" href="/yfhu-blog/assets/js/106.bdd597a1.js"><link rel="prefetch" href="/yfhu-blog/assets/js/107.70f24abd.js"><link rel="prefetch" href="/yfhu-blog/assets/js/108.f38a7bf3.js"><link rel="prefetch" href="/yfhu-blog/assets/js/109.93807b2b.js"><link rel="prefetch" href="/yfhu-blog/assets/js/11.4ab53e2e.js"><link rel="prefetch" href="/yfhu-blog/assets/js/110.4ed7caa5.js"><link rel="prefetch" href="/yfhu-blog/assets/js/12.55e6dd27.js"><link rel="prefetch" href="/yfhu-blog/assets/js/13.db58f40e.js"><link rel="prefetch" href="/yfhu-blog/assets/js/14.9c4249f3.js"><link rel="prefetch" href="/yfhu-blog/assets/js/15.1a62336a.js"><link rel="prefetch" href="/yfhu-blog/assets/js/16.e707c405.js"><link rel="prefetch" href="/yfhu-blog/assets/js/17.3bcebbd8.js"><link rel="prefetch" href="/yfhu-blog/assets/js/18.1014b253.js"><link rel="prefetch" href="/yfhu-blog/assets/js/19.68faed1e.js"><link rel="prefetch" href="/yfhu-blog/assets/js/20.eacb0e33.js"><link rel="prefetch" href="/yfhu-blog/assets/js/21.f0f61596.js"><link rel="prefetch" href="/yfhu-blog/assets/js/22.be32f3fe.js"><link rel="prefetch" href="/yfhu-blog/assets/js/23.d9f824c4.js"><link rel="prefetch" href="/yfhu-blog/assets/js/24.ea6e39d8.js"><link rel="prefetch" href="/yfhu-blog/assets/js/25.941da82e.js"><link rel="prefetch" href="/yfhu-blog/assets/js/26.a4348bcc.js"><link rel="prefetch" href="/yfhu-blog/assets/js/27.92c33173.js"><link rel="prefetch" href="/yfhu-blog/assets/js/28.15c1b145.js"><link rel="prefetch" href="/yfhu-blog/assets/js/29.c221cd56.js"><link rel="prefetch" href="/yfhu-blog/assets/js/3.8a850c6e.js"><link rel="prefetch" href="/yfhu-blog/assets/js/30.12433dd3.js"><link rel="prefetch" href="/yfhu-blog/assets/js/31.0f689dfa.js"><link rel="prefetch" href="/yfhu-blog/assets/js/32.3be1550c.js"><link rel="prefetch" href="/yfhu-blog/assets/js/33.b6f233f7.js"><link rel="prefetch" href="/yfhu-blog/assets/js/34.89b5200c.js"><link rel="prefetch" href="/yfhu-blog/assets/js/35.6c9788f1.js"><link rel="prefetch" href="/yfhu-blog/assets/js/36.d066c49f.js"><link rel="prefetch" href="/yfhu-blog/assets/js/37.843cd969.js"><link rel="prefetch" href="/yfhu-blog/assets/js/38.b4607b9b.js"><link rel="prefetch" href="/yfhu-blog/assets/js/39.945a36e8.js"><link rel="prefetch" href="/yfhu-blog/assets/js/4.921157a4.js"><link rel="prefetch" href="/yfhu-blog/assets/js/40.e00aaa56.js"><link rel="prefetch" href="/yfhu-blog/assets/js/41.7a6b8ce6.js"><link rel="prefetch" href="/yfhu-blog/assets/js/42.424f902f.js"><link rel="prefetch" href="/yfhu-blog/assets/js/43.7e5f306b.js"><link rel="prefetch" href="/yfhu-blog/assets/js/44.258ee3c5.js"><link rel="prefetch" href="/yfhu-blog/assets/js/45.dd42997e.js"><link rel="prefetch" href="/yfhu-blog/assets/js/46.5f7e013e.js"><link rel="prefetch" href="/yfhu-blog/assets/js/47.1829f43e.js"><link rel="prefetch" href="/yfhu-blog/assets/js/48.0189043c.js"><link rel="prefetch" href="/yfhu-blog/assets/js/49.f015b79a.js"><link rel="prefetch" href="/yfhu-blog/assets/js/5.c61a1379.js"><link rel="prefetch" href="/yfhu-blog/assets/js/50.b8deb708.js"><link rel="prefetch" href="/yfhu-blog/assets/js/51.238a04f1.js"><link rel="prefetch" href="/yfhu-blog/assets/js/52.1931afae.js"><link rel="prefetch" href="/yfhu-blog/assets/js/53.e35fc151.js"><link rel="prefetch" href="/yfhu-blog/assets/js/54.d21e4b66.js"><link rel="prefetch" href="/yfhu-blog/assets/js/55.4b1f1326.js"><link rel="prefetch" href="/yfhu-blog/assets/js/56.e08966b7.js"><link rel="prefetch" href="/yfhu-blog/assets/js/58.5cfe5f1b.js"><link rel="prefetch" href="/yfhu-blog/assets/js/59.2427b3e8.js"><link rel="prefetch" href="/yfhu-blog/assets/js/6.ce50b002.js"><link rel="prefetch" href="/yfhu-blog/assets/js/60.91285849.js"><link rel="prefetch" href="/yfhu-blog/assets/js/61.e1246b8c.js"><link rel="prefetch" href="/yfhu-blog/assets/js/62.be8bddad.js"><link rel="prefetch" href="/yfhu-blog/assets/js/63.dd5057d5.js"><link rel="prefetch" href="/yfhu-blog/assets/js/64.d4db7740.js"><link rel="prefetch" href="/yfhu-blog/assets/js/65.745918e8.js"><link rel="prefetch" href="/yfhu-blog/assets/js/66.78d4126b.js"><link rel="prefetch" href="/yfhu-blog/assets/js/67.ad295228.js"><link rel="prefetch" href="/yfhu-blog/assets/js/68.81c90da5.js"><link rel="prefetch" href="/yfhu-blog/assets/js/69.32e4997a.js"><link rel="prefetch" href="/yfhu-blog/assets/js/7.106529e6.js"><link rel="prefetch" href="/yfhu-blog/assets/js/70.cb1e83d2.js"><link rel="prefetch" href="/yfhu-blog/assets/js/71.ff866271.js"><link rel="prefetch" href="/yfhu-blog/assets/js/72.0e8d8a4c.js"><link rel="prefetch" href="/yfhu-blog/assets/js/73.c2f0d2df.js"><link rel="prefetch" href="/yfhu-blog/assets/js/74.9d3184cf.js"><link rel="prefetch" href="/yfhu-blog/assets/js/75.d309b35b.js"><link rel="prefetch" href="/yfhu-blog/assets/js/76.7849bcd8.js"><link rel="prefetch" href="/yfhu-blog/assets/js/77.453c92cf.js"><link rel="prefetch" href="/yfhu-blog/assets/js/78.136dffce.js"><link rel="prefetch" href="/yfhu-blog/assets/js/79.52ba2876.js"><link rel="prefetch" href="/yfhu-blog/assets/js/80.b17ad9b8.js"><link rel="prefetch" href="/yfhu-blog/assets/js/81.f06b1ed3.js"><link rel="prefetch" href="/yfhu-blog/assets/js/82.9129aeb4.js"><link rel="prefetch" href="/yfhu-blog/assets/js/83.b3bba2b6.js"><link rel="prefetch" href="/yfhu-blog/assets/js/84.5be70048.js"><link rel="prefetch" href="/yfhu-blog/assets/js/85.d2159e9b.js"><link rel="prefetch" href="/yfhu-blog/assets/js/86.af0a6296.js"><link rel="prefetch" href="/yfhu-blog/assets/js/87.ab983ed7.js"><link rel="prefetch" href="/yfhu-blog/assets/js/88.3baf0a1c.js"><link rel="prefetch" href="/yfhu-blog/assets/js/89.10083992.js"><link rel="prefetch" href="/yfhu-blog/assets/js/90.1e43848f.js"><link rel="prefetch" href="/yfhu-blog/assets/js/91.19a21ecc.js"><link rel="prefetch" href="/yfhu-blog/assets/js/92.0b98830a.js"><link rel="prefetch" href="/yfhu-blog/assets/js/93.9ae67a53.js"><link rel="prefetch" href="/yfhu-blog/assets/js/94.de39fa64.js"><link rel="prefetch" href="/yfhu-blog/assets/js/95.cb2e483e.js"><link rel="prefetch" href="/yfhu-blog/assets/js/96.1f1ade8d.js"><link rel="prefetch" href="/yfhu-blog/assets/js/97.5d607467.js"><link rel="prefetch" href="/yfhu-blog/assets/js/98.050005bd.js"><link rel="prefetch" href="/yfhu-blog/assets/js/99.68623fbf.js"><link rel="prefetch" href="/yfhu-blog/assets/js/vendors~docsearch.657e42b7.js">
    <link rel="stylesheet" href="/yfhu-blog/assets/css/0.styles.57c53af5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/yfhu-blog/" class="home-link router-link-active"><!----> <span class="site-name">vensst</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/yfhu-blog/guide/" class="nav-link">
  指南
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="插件" class="dropdown-title"><span class="title">插件</span> <span class="arrow down"></span></button> <button type="button" aria-label="插件" class="mobile-dropdown-title"><span class="title">插件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/yfhu-blog/js-toolkit/" class="nav-link">
  @vensst/js-toolkit
</a></li><li class="dropdown-item"><!----> <a href="/yfhu-blog/vue-widget/" class="nav-link">
  @vensst/vue-widget
</a></li><li class="dropdown-item"><!----> <a href="/yfhu-blog/cli/" class="nav-link">
  @vensst/cli
</a></li><li class="dropdown-item"><!----> <a href="https://vensst.github.io/ven-ui/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ven-ui
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="/yfhu-blog/record/" class="nav-link router-link-active">
  笔记
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="友情链接" class="dropdown-title"><span class="title">友情链接</span> <span class="arrow down"></span></button> <button type="button" aria-label="友情链接" class="mobile-dropdown-title"><span class="title">友情链接</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/vensst" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vensst
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/huyafei" target="_blank" rel="noopener noreferrer" class="nav-link external">
  huyafei
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/yfhu-blog/record/docker/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/yfhu-blog/en/" class="nav-link">
  English
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/yfhu-blog/guide/" class="nav-link">
  指南
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="插件" class="dropdown-title"><span class="title">插件</span> <span class="arrow down"></span></button> <button type="button" aria-label="插件" class="mobile-dropdown-title"><span class="title">插件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/yfhu-blog/js-toolkit/" class="nav-link">
  @vensst/js-toolkit
</a></li><li class="dropdown-item"><!----> <a href="/yfhu-blog/vue-widget/" class="nav-link">
  @vensst/vue-widget
</a></li><li class="dropdown-item"><!----> <a href="/yfhu-blog/cli/" class="nav-link">
  @vensst/cli
</a></li><li class="dropdown-item"><!----> <a href="https://vensst.github.io/ven-ui/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ven-ui
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="/yfhu-blog/record/" class="nav-link router-link-active">
  笔记
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="友情链接" class="dropdown-title"><span class="title">友情链接</span> <span class="arrow down"></span></button> <button type="button" aria-label="友情链接" class="mobile-dropdown-title"><span class="title">友情链接</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/vensst" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vensst
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/huyafei" target="_blank" rel="noopener noreferrer" class="nav-link external">
  huyafei
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/yfhu-blog/record/docker/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/yfhu-blog/en/" class="nav-link">
  English
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>笔记</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/yfhu-blog/record/" aria-current="page" class="sidebar-link">目录</a></li><li><a href="/yfhu-blog/record/html/" class="sidebar-link">html</a></li><li><a href="/yfhu-blog/record/css/" class="sidebar-link">css</a></li><li><a href="/yfhu-blog/record/js/" class="sidebar-link">js</a></li><li><a href="/yfhu-blog/record/vue/" class="sidebar-link">vue</a></li><li><a href="/yfhu-blog/record/react/" class="sidebar-link">React</a></li><li><a href="/yfhu-blog/record/node/" class="sidebar-link">node</a></li><li><a href="/yfhu-blog/record/webpack/" class="sidebar-link">webpack</a></li><li><a href="/yfhu-blog/record/github/" class="sidebar-link">github</a></li><li><a href="/yfhu-blog/record/linux/" class="sidebar-link">Linux</a></li><li><a href="/yfhu-blog/record/nginx/" class="sidebar-link">Nginx</a></li><li><a href="/yfhu-blog/record/docker/" aria-current="page" class="active sidebar-link">Docker</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#docker是什么" class="sidebar-link">Docker是什么？</a></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#解决什么问题" class="sidebar-link">解决什么问题？</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#传统虚拟机和容器" class="sidebar-link">传统虚拟机和容器</a></li></ul></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#安装" class="sidebar-link">安装</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#在-centos-7-上安装" class="sidebar-link">在 CentOS 7 上安装</a></li></ul></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#卸载" class="sidebar-link">卸载</a></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#docker的组成-核心" class="sidebar-link">docker的组成/核心</a></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#镜像加速" class="sidebar-link">镜像加速</a></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#docker-常用命令" class="sidebar-link">Docker 常用命令</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#启动类命令" class="sidebar-link">启动类命令</a></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#信息类命令" class="sidebar-link">信息类命令</a></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#镜像命令" class="sidebar-link">镜像命令</a></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#容器命令" class="sidebar-link">容器命令</a></li></ul></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#docker生成镜像" class="sidebar-link">docker生成镜像</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#相关命令" class="sidebar-link">相关命令</a></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#以在ubuntu加入vim功能为示例" class="sidebar-link">以在ubuntu加入vim功能为示例</a></li></ul></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#本地镜像发布到阿里云" class="sidebar-link">本地镜像发布到阿里云</a></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#本地镜像发布到私有库" class="sidebar-link">本地镜像发布到私有库</a></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#docker-容器数据卷" class="sidebar-link">docker 容器数据卷</a></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#docker-安装-nginx" class="sidebar-link">docker 安装 nginx</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#下载镜像前配置" class="sidebar-link">下载镜像前配置</a></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#拉取镜像" class="sidebar-link">拉取镜像</a></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#运行镜像" class="sidebar-link">运行镜像</a></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#配置-nginx-conf-可忽略" class="sidebar-link">配置 nginx.conf（可忽略）</a></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#拷贝容器内配置文件到宿主机" class="sidebar-link">拷贝容器内配置文件到宿主机</a></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#删除容器" class="sidebar-link">删除容器</a></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#重新运行容器" class="sidebar-link">重新运行容器</a></li></ul></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#docker-安装-jenkins" class="sidebar-link">docker 安装 jenkins</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#下载镜像前配置-2" class="sidebar-link">下载镜像前配置</a></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#拉取镜像-2" class="sidebar-link">拉取镜像</a></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#运行镜像-2" class="sidebar-link">运行镜像</a></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#获取密码登录-首次登录" class="sidebar-link">获取密码登录（首次登录）</a></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#问题与解决" class="sidebar-link">问题与解决</a></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#在jenkins中安装jdk" class="sidebar-link">在jenkins中安装jdk</a></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#在jenkins中安装maven" class="sidebar-link">在jenkins中安装maven</a></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#设置中文" class="sidebar-link">设置中文</a></li></ul></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#dokcerfile" class="sidebar-link">Dokcerfile</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#构建-dokcerfile-步骤" class="sidebar-link">构建 Dokcerfile 步骤</a></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#dokcerfile-基础知识" class="sidebar-link">Dokcerfile 基础知识</a></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#dokcerfile-执行流程" class="sidebar-link">Dokcerfile 执行流程</a></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#保留字指令" class="sidebar-link">保留字指令</a></li></ul></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#dockerfile-部署-springboot-项目到docker" class="sidebar-link">Dockerfile 部署 springboot 项目到docker</a></li><li class="sidebar-sub-header"><a href="/yfhu-blog/record/docker/#docker-转移所有环境到-新服务器" class="sidebar-link">Docker 转移所有环境到 新服务器</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>VuePress</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>微前端</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Java</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="docker"><a href="#docker" class="header-anchor">#</a> Docker</h1> <ul><li><a href="https://blog.csdn.net/MacWx/article/details/115670554" target="_blank" rel="noopener noreferrer">Docker学习中文文档大全、docker&amp;docker-compose实战<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://vuepress.mirror.docker-practice.com/" target="_blank" rel="noopener noreferrer">Docker 从入门到实践<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="docker是什么"><a href="#docker是什么" class="header-anchor">#</a> Docker是什么？</h2> <ul><li><a href="https://www.yuque.com/tmfl/cloud/rifotq" target="_blank" rel="noopener noreferrer">01-Docker概述 (yuque.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>docker 是go语言开发实现的，是一个开源的应用容器引擎，基于 Linux 内核轻量级虚拟机，属于操作系统层面的<strong>容器虚拟化技术</strong>。</p> <p>docker是虚拟化容器技术。</p> <h2 id="解决什么问题"><a href="#解决什么问题" class="header-anchor">#</a> 解决什么问题？</h2> <p>部署项目：</p> <p>​	docker出现前：在虚拟机上配置项目运行环境比如安装mysql+NGINX+Redis+java环境等等，如果分为开发，测试和正式环境，每个都要安装软件和配置环境，可能导致安装软件版本以及配置不一致导出出错，问题多、麻烦、容易出错，换台机器得重来一次，那么安装时原始环境是否可以一并复制过来？</p> <p>​	docker出现后：开发环境运行正常，将源码、系统、软件及版本、环境配置等等打包成一个镜像文件，<strong>一次使用到处运行</strong></p> <p>Linux容器技术的出现就解决了这样一个问题，而 Docker 就是在它的基础上发展过来的。将应用打成镜像，通过镜像成为运行在Docker容器上面的实例，而 Docker容器在任何操作系统上都是一致的，这就实现了跨平台、跨服务器。只需要一次配置好环境，换到别的机子上就可以一键部署好，大大简化了操作</p> <h3 id="传统虚拟机和容器"><a href="#传统虚拟机和容器" class="header-anchor">#</a> 传统虚拟机和容器</h3> <p>传统虚拟机（virtual machine）：</p> <p>​	传统虚拟机技术基于安装在主操作系统上的虚拟机管理系统（如VirtualBox、VMware等），创建虚拟机（虚拟出各种硬件），在虚拟机上安装从操作系统，在从操作系统中安装部署各种应用。缺点：资源占用多、冗余步骤多、启动慢</p> <p>Linux容器（Linux Container，简称LXC）：</p> <p>​	Linux容器是与系统其他部分分隔开的一系列进程，从另一个镜像运行，并由该镜像提供支持进程所需的全部文件。容器提供的镜像包含了应用的所有依赖项，因而在从开发到测试再到生产的整个过程中，它都具有可移植性和一致性。</p> <p>​		Linux容器不是模拟一个完整的操作系统，而是对进程进行隔离。有了容器，就可以将软件运行所需的所有资源打包到一个隔离的容器中。容器与虚拟机不同，不需要捆绑一整套操作系统，只需要软件工作所需的库资源和设置。系统因此而变得高效轻量并保证部署在任何环境中的软件都能始终如一的运行。</p> <h2 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h2> <h3 id="在-centos-7-上安装"><a href="#在-centos-7-上安装" class="header-anchor">#</a> 在 CentOS 7 上安装</h3> <p><a href="https://docs.docker.com/engine/install/centos/" target="_blank" rel="noopener noreferrer">官方CentOS安装教程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
注意步骤4，步骤5</p> <ol><li><p>查看系统信息是否是 CentOS 7以上</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 查看系统版本</span>
<span class="token function">cat</span> /etc/redhat-release
<span class="token comment"># 查看内核版本</span>
<span class="token function">uname</span> <span class="token parameter variable">-r</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>移除旧的版本</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> yum remove <span class="token function">docker</span> <span class="token punctuation">\</span>
                docker-client <span class="token punctuation">\</span>
                docker-client-latest <span class="token punctuation">\</span>
                docker-common <span class="token punctuation">\</span>
                docker-latest <span class="token punctuation">\</span>
                docker-latest-logrotate <span class="token punctuation">\</span>
                docker-logrotate <span class="token punctuation">\</span>
                docker-engine
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>备注：</strong>
\ 换行符</p></li> <li><p>安装必要系统工具</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> yum <span class="token function">install</span> <span class="token parameter variable">-y</span> yum-utils 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>备注：</strong>
安装yum-utils包（提供yum-config-manager 实用程序）</p></li> <li><p>设置镜像仓库</p> <ul><li>官方仓库【不推荐】</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>阿里云仓库【推荐】</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>更新yum工具</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> yum makecache fast
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>安装 Docker 包
安装最新版本</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> yum <span class="token function">install</span> docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>备注：</strong></p> <ul><li>docker-ce：Docker 引擎</li> <li>docker-ce-cli：Docker 命令行工具</li> <li>containerd.io：容器运行时</li> <li>docker-buildx-plugin：Docker Buildx 插件</li> <li>docker-compose-plugin：Docker Compose 插件</li> <li></li></ul></li> <li><p>启动 Docker</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> systemctl start <span class="token function">docker</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>**备注：**systemctl 英文词组”system control“的缩写，用于管理系统服务。
语法格式：systemctl 参数 服务常用参数：</p> <ul><li>start 启动服务</li> <li>stop 停止服务</li> <li>restart 重启服务</li> <li>enable 使某服务开机自启</li> <li>disable 关闭某服务开机自启</li> <li>status 查看服务状态</li> <li>list -units --type=service 列举所有已启动服务</li></ul></li> <li><p>查看 Docker 版本，验证是否启动成功</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> version
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>测试</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">docker</span> run hello-world
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>停止 Docker</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> systemctl stop <span class="token function">docker</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ol> <h2 id="卸载"><a href="#卸载" class="header-anchor">#</a> 卸载</h2> <ol><li><p>卸载安装包</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> yum remove docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>删除镜像、容器、配置文件等内容</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">rm</span> <span class="token parameter variable">-rf</span> /var/lib/docker
<span class="token function">sudo</span> <span class="token function">rm</span> <span class="token parameter variable">-rf</span> /var/lib/containerd
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>docker 文件位置及作用</p> <ul><li>/var/lib/docker：docker 镜像、容器、网络、卷等数据的保存目录</li> <li>/etc/docker：docker 的配置文件目录，默认没有daemon.json文件
<ul><li>/etc/docker/daemon.json</li></ul></li> <li>/usr/bin/docker：docker 的二进制可执行文件</li> <li>/usr/lib/systemd/system/docker.service：docker 的 systemd 配置文件</li> <li>/var/run/docker.sock：docker 的 socket 文件</li></ul></li></ol> <h2 id="docker的组成-核心"><a href="#docker的组成-核心" class="header-anchor">#</a> docker的组成/核心</h2> <p><img src="/static/images/docker/01.jpg" alt="01"></p> <ul><li>镜像（Image）一个镜像代表一个应用环境，是一个<strong>只读</strong>的模板。镜像用来创建 Docker 容器，一个镜像可以创建多个容器。比如nginx、jekins镜像等。</li> <li>容器（Container）是用镜像创建出来的运行实例可读可写。与镜像的关系类似java中类（镜像）与实例对象（容器）一样。</li> <li>仓库（Repository）是集中存放镜像文件的场所。类似 github 仓库存放 git 项目一样。</li> <li><code>dockerFile:</code>docker生成镜像配置文件,用来书写自定义镜像的一些配置</li> <li><code>tar:</code>一个对镜像打包的文件,日后可以还原成镜像</li></ul> <h2 id="镜像加速"><a href="#镜像加速" class="header-anchor">#</a> 镜像加速</h2> <p>国内从 DockerHub 拉取镜像有时会遇到困难，因此需要配置镜像加速器。
阿里云镜像地址：<a href="https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors" target="_blank" rel="noopener noreferrer">https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><a href="https://www.runoob.com/docker/docker-mirror-acceleration.html" target="_blank" rel="noopener noreferrer">参考地址<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ol><li><p>登录阿里云，进入容器<strong>镜像服务控制台</strong>，选择左侧菜单栏的<strong>镜像加速器</strong></p></li> <li><p>配置镜像加速器
有两种方式：</p> <ol><li><p>直接复制粘贴</p></li> <li><p>在/etc/docker下 创建、编辑 daemon.json 文件</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">touch</span> /etc/docker/daemon.json
<span class="token function">sudo</span> <span class="token function">vim</span> /etc/docker/daemon.json
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>内容如下：</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;registry-mirrors&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;https://自己的编码.mirror.aliyuncs.com&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ol></li> <li><p>重启 Docker 服务</p></li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> systemctl daemon-reload
<span class="token function">sudo</span> systemctl restart <span class="token function">docker</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol start="4"><li>验证是否配置成功</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">docker</span> info
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="docker-常用命令"><a href="#docker-常用命令" class="header-anchor">#</a> Docker 常用命令</h2> <h3 id="启动类命令"><a href="#启动类命令" class="header-anchor">#</a> 启动类命令</h3> <ul><li>systemctl start docker：启动 Docker</li> <li>systemctl stop docker：停止 Docker</li> <li>systemctl restart docker：重启 Docker</li> <li>systemctl status docker：查看 Docker 状态</li> <li>systemctl enable docker：设置 Docker 开机自启</li> <li>systemctl disable docker：取消 Docker 开机自启</li></ul> <h3 id="信息类命令"><a href="#信息类命令" class="header-anchor">#</a> 信息类命令</h3> <ul><li>docker version：查看 Docker 版本信息</li> <li>docker info：查看 Docker 系统信息</li> <li>docker help：查看 Docker 帮助信息</li> <li>docker 具体命令 --help：查看docker具体命令的帮助信息</li></ul> <h3 id="镜像命令"><a href="#镜像命令" class="header-anchor">#</a> 镜像命令</h3> <ul><li><p>docker images：查看本地镜像。-a 所有镜像 ，-q 只显示镜像id，例如：docker images -a</p></li> <li><p>docker search 镜像名：搜索镜像</p></li> <li><p>docker pull 镜像名：拉取镜像（ docker pull 镜像名:版本号，没有表示:last拉取最新版本）</p></li> <li><p>docker run 镜像名：运行镜像创建一个新容器。 例如：docker run -it --name myTomcat -p 8888:8080 tomcat</p></li> <li><p><strong>docker run [OPTIONS] IMAGE [COMMAND] [ARG...] 运行镜像创建一个新容器</strong></p> <ul><li>OPTIONS</li> <li>-d：后台运行容器，并返回容器ID</li> <li>-i：以交互模式运行容器，通常与 -t 同时使用</li> <li>-t：为容器重新分配一个伪输入终端，通常与 -i 同时使用</li> <li>-p：端口映射，格式为：主机(宿主)端口:容器端口</li> <li>-v：挂载数据卷，格式为：主机(宿主)目录:容器目录</li> <li>--name=容器名称：为容器指定一个名称</li> <li>-rm：容器退出时自动删除容器文件</li> <li>-e：设置环境变量</li> <li>-link：链接到另一个容器
例如：</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 使用镜像centos:latest以交互模式启动一个容器,在容器内执行/bin/bash命令</span>
<span class="token comment"># Docker 以 centos 镜像创建一个新容器，然后在容器里执行 /bin/bash 命令</span>
<span class="token function">docker</span> run <span class="token parameter variable">-it</span> centos /bin/bash
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>参数说明：</p> <ul><li><p>-i: 交互式操作。</p> <ul><li>-t: 终端。</li> <li>centos 表示镜像。centos 镜像（也可以centos:版本号）。</li> <li>/bin/bash：放在镜像名后的是命令，这里我们希望有个交互式 Shell，因此用的是 /bin/bash。</li> <li><strong>要退出终端，直接输入 exit 或者 Ctrl+D 即可。（使用exit退出容器会停止运行，ctrl+p+q容器不停止）</strong></li></ul></li></ul></li> <li><p>docker rmi 镜像ID：删除镜像(强制单个：docker rmi -f 镜像ID，)</p></li> <li><p>docker commit 容器ID 新镜像名：提交容器生成镜像</p></li> <li><p><strong>docker build -t 镜像名 Dockerfile所在目录：根据 Dockerfile 构建镜像</strong></p></li> <li><p>docker push 镜像名：推送镜像到 DockerHub</p></li> <li><p>docker tag 镜像ID 新镜像名：给镜像打标签</p></li> <li><p>docker history 镜像名：查看镜像的历史记录</p></li> <li><p>**docker save -o 镜像名.tar 镜像名  ** ：导出镜像1</p></li> <li><p><strong>docker save 镜像名 &gt; 镜像名.tar</strong> ：导出镜像2</p></li> <li><p><strong>docker load -i 镜像名.tar</strong> ：导入镜像</p></li> <li><p>docker system df：查看镜像占用空间</p></li></ul> <h3 id="容器命令"><a href="#容器命令" class="header-anchor">#</a> 容器命令</h3> <ul><li><p>docker ps：查看正在运行的容器</p></li> <li><p>docker ps [OPTIONS] ：查看所有容器，列出当前所有正在运行的容器+历史上运行过的容器</p> <ul><li>-a：运行容器和历史容器</li> <li>-q :  静默模式，只显示容器编号。</li> <li>-l :   显示最近创建的容器。</li> <li>-n：显示最近n个创建的容器。</li></ul></li> <li><p>docker start 容器名/容器ID：启动容器</p></li> <li><p>docker stop 容器名/容器ID：停止容器</p></li> <li><p>docker kill 容器名/容器ID：强制停止容器</p></li> <li><p>docker restart 容器名/容器ID：重启容器</p></li> <li><p>docker attach 容器ID：进入容器（使用exit退出容器会停止）</p></li> <li><p><strong>docker exec -it 容器ID /bin/bash：进入容器【推荐】（使用exit退出容器不会停止，exec是在容器中打开新的终端，并且启动新的进程）</strong></p> <ul><li><p>-i  以交互模式运行容器，通常与-t一起使用</p></li> <li><p>-t  分配一个伪终端    shell窗口   bash</p> <p>redis一般先用 docker run -d IMAGE 启动程序，然后用 docker exec -it CONTAINER /bin/bash 进入容器，然后执行 ps -ef
查看进程，然后执行 kill -9 PID 杀掉进程，最后执行 exit 退出容器。</p></li></ul></li> <li><p>docker rm 容器ID：删除已停止的容器</p> <ul><li>docker rm -f $(docker ps -aq)：删除所有容器</li> <li>docker rm -f $(docker ps -a -q)：删除所有容器</li></ul></li> <li><p>docker logs [OPTIONS] 容器名/容器ID：查看容器日志</p></li> <li><p>docker inspect 容器ID：查看容器详细信息</p></li> <li><p>docker top 容器名/容器ID：查看容器内运行的进程</p></li> <li><p>docker cp 容器ID:容器内路径 主机路径：将容器内文件拷贝到主机</p> <ul><li>docker cp 主机路径 容器ID:容器内路径：将宿主机复制到容器内部</li></ul></li> <li><p>导入和导出容器</p> <ul><li>docker export 容器ID &gt; 容器.tar：导出容器</li> <li>docker import 容器.tar 镜像名：导入容器</li></ul></li> <li><p>docker port 容器ID：查看容器端口映射</p></li> <li><p>docker stats 容器ID：查看容器资源占用情况</p></li> <li><p>docker diff 容器ID：查看容器文件变化</p></li></ul> <h2 id="docker生成镜像"><a href="#docker生成镜像" class="header-anchor">#</a> docker生成镜像</h2> <h3 id="相关命令"><a href="#相关命令" class="header-anchor">#</a> 相关命令</h3> <ol><li>docker commit 容器ID 新镜像名：提交容器生成镜像</li> <li>docker commit -m=&quot;提交的描述信息&quot; -a=&quot;作者&quot; 容器ID 镜像名:版本号</li> <li>docker build -t 镜像名 Dockerfile 所在目录：根据 Dockerfile 构建镜像</li></ol> <h3 id="以在ubuntu加入vim功能为示例"><a href="#以在ubuntu加入vim功能为示例" class="header-anchor">#</a> 以在ubuntu加入vim功能为示例</h3> <ol><li>从 hub.docker.com 拉取 ubuntu 镜像</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> pull ubuntu
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="2"><li>运行 ubuntu 镜像</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> run <span class="token parameter variable">-it</span> ubuntu /bin/bash
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="3"><li>在容器中安装 vim
默认Ubuntu镜像中没有vim，所以需要在容器中安装vim 测试：vim a.text</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>    <span class="token comment"># 先更新管理工具</span>
    <span class="token function">apt-get</span> update
    <span class="token comment"># 安装 vim </span>
    <span class="token function">apt-get</span> <span class="token parameter variable">-y</span> <span class="token function">install</span> <span class="token function">vim</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ol start="4"><li>退出容器</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>    <span class="token builtin class-name">exit</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="5"><li>提交容器生成镜像</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>    <span class="token comment"># docker commit -m=&quot;提交的描述信息&quot; -a &quot;作者&quot; 容器ID 镜像名:版本号</span>
    <span class="token function">docker</span> commit <span class="token parameter variable">-m</span><span class="token operator">=</span><span class="token string">&quot;add vim&quot;</span> <span class="token parameter variable">-a</span> <span class="token string">&quot;zhangsan&quot;</span> 1d1f1f1f1f1f ubuntu:v1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol start="6"><li>查看镜像</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>    <span class="token function">docker</span> images
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="7"><li>运行镜像</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>    <span class="token function">docker</span> run <span class="token parameter variable">-it</span> ubuntu:v1 /bin/bash
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="8"><li>测试vim</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>    <span class="token function">vim</span> a.text
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>备注：</strong></p> <ul><li>慎用 docker commit，此操作为黑箱操作，因为只有制作此镜像的人才知道执行过什么命令，时间久会忘记。使用 Dockerfile 定制镜像</li></ul> <h2 id="本地镜像发布到阿里云"><a href="#本地镜像发布到阿里云" class="header-anchor">#</a> 本地镜像发布到阿里云</h2> <p>接以上生成本地镜像流程，将本地镜像上传到阿里云</p> <ol><li>进入阿里云<code>容器镜像服务</code></li> <li>创建<code>命名空间</code></li> <li>创建<code>镜像仓库</code></li> <li>进入操作<code>管理</code>界面获取脚本（得到步骤5、步骤6的命令）</li> <li>将镜像推送到阿里云
<ol><li>登录阿里云Docker Registry</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code> <span class="token function">docker</span> login <span class="token parameter variable">--username</span><span class="token operator">=</span>dq_hyf9527 registry.cn-hangzhou.aliyuncs.com
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="2"><li>将镜像推送到Registry</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code> <span class="token function">docker</span> tag 镜像ID registry.cn-hangzhou.aliyuncs.com/命名空间/镜像名:版本号
 <span class="token function">docker</span> push registry.cn-hangzhou.aliyuncs.com/命名空间/镜像名:版本号
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li>从阿里云下载镜像<div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> pull registry.cn-hangzhou.aliyuncs.com/vensst/myubuntu:<span class="token punctuation">[</span>镜像版本号<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ol> <h2 id="本地镜像发布到私有库"><a href="#本地镜像发布到私有库" class="header-anchor">#</a> 本地镜像发布到私有库</h2> <p>Docker Registry是官方提供的工具，可以用于构建私有镜像仓库</p> <ol><li><p>下载 Docker Registry</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> pull registry
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>运行 Docker Registry 生成私有docker hub镜像仓库</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code> <span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">5000</span>:5000 <span class="token parameter variable">-v</span> /vensst/myregistry/:/tmp/registry <span class="token parameter variable">--privileged</span><span class="token operator">=</span>true registry
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>docker inspect 容器ID：查看容器详细信息</p></li> <li><p>以 ubuntu 安装 ifconfig 命令为例，将镜像推送到私有镜像仓库</p> <ol><li>下载并运行ubuntu镜像</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code> <span class="token function">docker</span> pull ubuntu
 <span class="token function">docker</span> run <span class="token parameter variable">-it</span> ubuntu /bin/bash
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol start="2"><li>安装 ifconfig</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code> <span class="token function">apt-get</span> update
 <span class="token function">apt-get</span> <span class="token function">install</span> net-tools
 <span class="token comment"># 验证</span>
 <span class="token function">ifconfig</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ol start="3"><li>commit 容器生成镜像</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code> <span class="token function">docker</span> commit <span class="token parameter variable">-m</span><span class="token operator">=</span><span class="token string">&quot;add ifconfig&quot;</span> <span class="token parameter variable">-a</span><span class="token operator">=</span><span class="token string">&quot;yfhu&quot;</span> 1d1f1f1f1f1f myubuntu:1.2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="4"><li>运行私有镜像仓库</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code> <span class="token function">docker</span> run <span class="token parameter variable">-it</span> myubuntu:1.2 /bin/bash
 <span class="token function">ifconfig</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>使用curl 验证私有库有什么镜像</p></li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">curl</span> <span class="token parameter variable">-XGET</span> http://81.69.44.160:5000/v2/_catalog
<span class="token comment"># {&quot;repositories&quot;:[]} 说明没有镜像</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol start="5"><li>将新镜像修改符合私服规范的tag
公式：docker tag 镜像:Tag Host:Port/Repository:Tag</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> tag myubuntu:1.2 <span class="token number">81.69</span>.44.160:5000/myubuntu:1.2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="6"><li>修改配置文件使之支持http</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 查看配置文件</span>
<span class="token function">cat</span> /etc/docker/daemon.json
<span class="token comment"># 修改配置文件</span>
<span class="token function">vim</span> /etc/docker/daemon.json
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>新增&quot;insecure-registries&quot;: [&quot;192.168.111.162:5000&quot;]</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;registry-mirrors&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;https://aa25jngu.mirror.aliyuncs.com&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;insecure-registries&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;192.168.111.162:5000&quot;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>修改好重启docker服务</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>systemctl restart <span class="token function">docker</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="7"><li>将镜像推送到私有镜像仓库</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code> <span class="token function">docker</span> push <span class="token number">81.69</span>.44.160:5000/yfhuubuntu:1.2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="8"><li>使用curl 验证私有库有什么镜像2</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">curl</span> <span class="token parameter variable">-XGET</span> http://81.69.44.160:5000/v2/_catalog
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="9"><li>从私有镜像仓库下载镜像</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> pull <span class="token number">81.69</span>.44.160:5000/yfhuubuntu:1.2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="docker-容器数据卷"><a href="#docker-容器数据卷" class="header-anchor">#</a> docker 容器数据卷</h2> <p>Docker容器数据卷（Volumes）是Docker中用于持久化和共享数据的一种机制。在Docker容器的生命周期中，容器内部的文件系统是临时性的，当容器停止或删除时，其所有更改通常都会丢失。为了确保重要数据能够跨容器持久存储，并且能够在多个容器之间共享，Docker引入了数据卷的概念。</p> <p>docker run -it --privileged=true -v /宿主机绝对路径目录:/容器内目录 镜像名</p> <h2 id="docker-安装-nginx"><a href="#docker-安装-nginx" class="header-anchor">#</a> docker 安装 nginx</h2> <h3 id="下载镜像前配置"><a href="#下载镜像前配置" class="header-anchor">#</a> 下载镜像前配置</h3> <p>目的是将nginx的配置文件、日志文件、网站文件、证书文件挂载到宿主机的目录</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 创建挂载目录 -p 递归创建</span>
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /vensst/nginx/conf
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /vensst/nginx/log
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /vensst/nginx/html
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /vensst/nginx/ssl
<span class="token comment"># 或者</span>
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /vensst	/nginx/<span class="token punctuation">{</span>conf,html,log,ssl<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="拉取镜像"><a href="#拉取镜像" class="header-anchor">#</a> 拉取镜像</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> pull nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="运行镜像"><a href="#运行镜像" class="header-anchor">#</a> 运行镜像</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">9001</span>:80 <span class="token parameter variable">--name</span> nginx-vensst nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>备注：</strong></p> <ul><li><p>nginx 镜像默认的端口是80</p></li> <li><p>nginx 镜像内文件位置说明</p> <ul><li>默认的配置文件在容器的<code>/etc/nginx/nginx.conf</code></li> <li>默认的配置文件夹在容器的<code>/etc/nginx/conf.d</code></li> <li>默认的网站文件在容器的<code>/usr/share/nginx/html</code></li> <li>默认的日志文件在容器的<code>/var/log/nginx</code></li></ul></li></ul> <h3 id="配置-nginx-conf-可忽略"><a href="#配置-nginx-conf-可忽略" class="header-anchor">#</a> 配置 nginx.conf（可忽略）</h3> <ul><li><p>进入容器<br>
docker exec -it nginx-vensst /bin/bash</p></li> <li><p>查找 nginx 目录</p> <p>whereis nginx</p></li> <li><p>修改nginx配置文件<br>
vim /etc/nginx/nginx.conf</p></li> <li><p>重启nginx<br>
nginx -s reload</p></li> <li><p>退出容器</p> <p>exit</p></li></ul> <h3 id="拷贝容器内配置文件到宿主机"><a href="#拷贝容器内配置文件到宿主机" class="header-anchor">#</a> 拷贝容器内配置文件到宿主机</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># docker cp 容器id|容器名称:/etc/nginx/nginx.conf 宿主机目录</span>
<span class="token comment"># 将容器nginx.conf文件复制到宿主机</span>
<span class="token function">docker</span> <span class="token function">cp</span> nginx-vensst:/etc/nginx/nginx.conf /vensst/nginx/conf/nginx.conf
<span class="token comment"># 将容器conf.d文件夹下内容复制到宿主机</span>
<span class="token function">docker</span> <span class="token function">cp</span> nginx-vensst:/etc/nginx/conf.d /vensst/nginx/conf/
<span class="token comment"># 将容器中的html文件夹复制到宿主机(部署项目放到这里)</span>
<span class="token function">docker</span> <span class="token function">cp</span> nginx-vensst:/usr/share/nginx/html /vensst/nginx/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>备注：</strong></p> <ul><li>nginx.conf` 主配置文件中包含了一个 include 指令，指向此目录下的所有 .conf 文件</li></ul> <h3 id="删除容器"><a href="#删除容器" class="header-anchor">#</a> 删除容器</h3> <p>或者使用命令 docker rm -f nginx-vensst 直接删除正在运行的 nginx-vensst 容器</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 直接执行docker rm nginx或者以容器id方式关闭容器</span>
<span class="token comment"># 找到nginx对应的容器id</span>
<span class="token function">docker</span> <span class="token function">ps</span> <span class="token parameter variable">-a</span>
<span class="token comment"># 关闭该容器</span>
<span class="token function">docker</span> stop nginx-vensst
<span class="token comment"># 删除该容器</span>
<span class="token function">docker</span> <span class="token function">rm</span> nginx-vensst
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="重新运行容器"><a href="#重新运行容器" class="header-anchor">#</a> 重新运行容器</h3> <p>此时将宿主机上的配置文件和文档根目录挂载到容器上，后续改配置就在宿主机上改自动映射到容器内。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> run <span class="token parameter variable">--name</span> nginx-vensst <span class="token punctuation">\</span>
<span class="token parameter variable">-p</span> <span class="token number">9001</span>:80 <span class="token punctuation">\</span>
<span class="token parameter variable">--privileged</span><span class="token operator">=</span>true <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /vensst/nginx/conf/nginx.conf:/etc/nginx/nginx.conf <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /vensst/nginx/conf/conf.d:/etc/nginx/conf.d <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /vensst/nginx/html:/usr/share/nginx/html <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /vensst/nginx/log:/var/log/nginx <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /vensst/nginx/ssl:/etc/nginx/ssl/ <span class="token punctuation">\</span>
<span class="token parameter variable">-d</span> nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul><li>--privileged=true :  访问权限</li></ul> <h2 id="docker-安装-jenkins"><a href="#docker-安装-jenkins" class="header-anchor">#</a> docker 安装 jenkins</h2> <h3 id="下载镜像前配置-2"><a href="#下载镜像前配置-2" class="header-anchor">#</a> 下载镜像前配置</h3> <p>目的是将jenkins的配置文件、日志文件、网站文件挂载到宿主机的目录</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 创建挂载目录 -p 递归创建</span>
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /vensst/jenkins/jenkins_home
<span class="token comment"># 文件授权，不授权的话无法启动运行 jenkins 参考：https://www.linuxcool.com/chmod</span>
<span class="token function">chmod</span> <span class="token number">777</span> /vensst/jenkins/jenkins_home
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="拉取镜像-2"><a href="#拉取镜像-2" class="header-anchor">#</a> 拉取镜像</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li>jenkins停用，选择 jenkins/jenkins 或 jenkinsci/blueocean</li></ul></div> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> pull jenkins/jenkins:lts-jdk11
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="运行镜像-2"><a href="#运行镜像-2" class="header-anchor">#</a> 运行镜像</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">7227</span>:8080 <span class="token parameter variable">-p</span> <span class="token number">50000</span>:50000 <span class="token parameter variable">--name</span> jenkins-vensst <span class="token parameter variable">--privileged</span><span class="token operator">=</span>true <span class="token parameter variable">-v</span> /vensst/jenkins/jenkins_home:/var/jenkins_home jenkins/jenkins:lts-jdk11
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>备注：</strong></p> <ul><li>8080端口是jenkins的web访问端口,50000端口是jenkins的代理端口</li> <li>jenkins 文件位置说明
<ul><li>jenkins镜像默认的配置文件在容器的<code>/var/jenkins_home</code></li> <li>jenkins镜像默认的日志文件在容器的<code>/var/log/jenkins</code></li> <li>jenkins镜像默认的端口是8080</li></ul></li></ul> <h3 id="获取密码登录-首次登录"><a href="#获取密码登录-首次登录" class="header-anchor">#</a> 获取密码登录（首次登录）</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 容器在 /var/jenkins_home/secrets/initialAdminPassword 位置，下面是挂载在外部目录位置</span>
<span class="token function">vim</span> /vensst/jenkins/jenkins_home/secrets/initialAdminPassword
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="问题与解决"><a href="#问题与解决" class="header-anchor">#</a> 问题与解决</h3> <ul><li><p>插件安装失败</p> <ul><li>原因：一般是因为jenkins与插件版本不适应</li> <li>解决：系统管理-&gt;插件管理-&gt;高级-&gt;升级站点-&gt;修改对应的url（<a href="https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/" target="_blank" rel="noopener noreferrer">查询地址<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>）-&gt;提交-&gt;重启jenkins</li></ul></li> <li><p>重启</p> <ul><li>安全重启：<code>http://[jenkins-server]/safeRestart</code></li> <li>立即重启：<code>http://[jenkins-server]/restart</code></li></ul> <p>请将 <code>[jenkins-server]</code> 替换为您的 Jenkins 服务器地址</p></li></ul> <h3 id="在jenkins中安装jdk"><a href="#在jenkins中安装jdk" class="header-anchor">#</a> 在jenkins中安装jdk</h3> <ul><li>系统管理-&gt;全局工具配置-&gt;JDK-&gt;新增JDK-&gt;自动安装-&gt;输入版本号-&gt;保存</li> <li>1:别名随便取 2:版本id是8u开头 3.此处会有登录提示需要配置oracle账号
<img src="/static/images/jenkins/jenkin_jdk_az.jpg" alt="jenkins中jdk使用"></li></ul> <h3 id="在jenkins中安装maven"><a href="#在jenkins中安装maven" class="header-anchor">#</a> 在jenkins中安装maven</h3> <ul><li>系统管理-&gt;全局工具配置-&gt;Maven-&gt;新增Maven-&gt;自动安装-&gt;选择版本-&gt;保存</li></ul> <h3 id="设置中文"><a href="#设置中文" class="header-anchor">#</a> 设置中文</h3> <ul><li>安装插件 Locale</li></ul> <h2 id="dokcerfile"><a href="#dokcerfile" class="header-anchor">#</a> Dokcerfile</h2> <p>Dokcerfile 是用来构建 Docker 镜像的文本文件，有一条条构建镜像的所需的指令和参数构成的脚本。</p> <h3 id="构建-dokcerfile-步骤"><a href="#构建-dokcerfile-步骤" class="header-anchor">#</a> 构建 Dokcerfile 步骤</h3> <ul><li><p>编写 Dokcerfile 文件</p></li> <li><p>docker build 命令构建镜像</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 要起镜像名字和版本标签， TAG后面还有个点指 Dcokerfile 位置，点表示当前</span>
<span class="token function">docker</span> build 新镜像名:TAG <span class="token builtin class-name">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>docker run 运行镜像创建容器实例，参考：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> run <span class="token parameter variable">-it</span> 新镜像名:TAG /bin/bash
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul> <h3 id="dokcerfile-基础知识"><a href="#dokcerfile-基础知识" class="header-anchor">#</a> Dokcerfile 基础知识</h3> <ul><li>保留字必须大写 且至少有一个参数</li> <li>指令从上倒下，按顺序执行</li> <li># 注释</li> <li>每条指令都会创建一个新的镜像层并对进行提交</li></ul> <h3 id="dokcerfile-执行流程"><a href="#dokcerfile-执行流程" class="header-anchor">#</a> Dokcerfile 执行流程</h3> <ul><li>docker 从基础镜像运行一个容器</li></ul> <h3 id="保留字指令"><a href="#保留字指令" class="header-anchor">#</a> 保留字指令</h3> <p><a href="https://docs.docker.com/reference/dockerfile/" target="_blank" rel="noopener noreferrer">Dockerfile 参考 |Docker 文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <table><thead><tr><th>保留字</th> <th>作用</th></tr></thead> <tbody><tr><td><strong>FROM</strong></td> <td><strong>当前镜像是基于哪个镜像的</strong> <code>第一个指令必须是FROM</code>。&lt;br /&gt;语法：FROM &lt;image&gt;[:&lt;tag&gt;]</td></tr> <tr><td>MAINTAINER</td> <td><strong>镜像维护者的姓名和邮箱地址。</strong> &lt;br /&gt;语法：MAINTAINER &lt;name&gt;</td></tr> <tr><td><strong>RUN</strong></td> <td><strong>容器构建时需要运行的指令。</strong>&lt;br /&gt;语法：RUN &lt;命令行命令&gt; 或者 RUN [&quot;/bin/bash&quot;, &quot;-c&quot;, &quot;echo hello&quot;] 写法等价 RUN /bin/bash -c echo hello</td></tr> <tr><td><strong>EXPOSE</strong></td> <td><strong>当前容器对外暴露出的端口号，TCP（默） 或 UDP。</strong>&lt;br /&gt;语法：EXPOSE 80/tcp</td></tr> <tr><td><strong>WORKDIR</strong></td> <td><strong>指定在创建容器后，终端默认登录进来的工作目录，一个落脚点。</strong> docker run 之后默认目录位置&lt;br /&gt;语法：WORKDIR 路径 &lt;br /&gt;例如：WORKDIR /usr/var</td></tr> <tr><td><strong>ENV</strong></td> <td><strong>用来在构建镜像过程中设置环境变量</strong>。&lt;br /&gt;语法：ENV &lt;key&gt; &lt;value&gt; 或者 ENV &lt;key&gt;=&lt;value&gt;  &lt;br /&gt;例如：ENV MY_PATH /usr/mytest 也可以在其它指令使用，比如：WORKDIR $MY_PATH</td></tr> <tr><td><strong>ADD</strong></td> <td><strong>将宿主机目录下的文件拷贝进镜像且ADD命令会自动处理URL和解压tar包。</strong> &lt;br /&gt;语法：ADD 宿主机文件路径 容器路径&lt;br /&gt;例如：ADD hom* /mydir/       通配符添加多个文件</td></tr> <tr><td><strong>COPY</strong></td> <td><strong>类似于ADD，拷贝文件和目录到镜像中 将从构建上下文目录中&lt;原路径&gt;的文件/目录复制到新的一层的镜像内的&lt;目标路径&gt;位置</strong>&lt;br /&gt;语法：COPY src dest 或者 COPY [&quot;src&quot;,&quot;dest&quot;] src：源路径 dest：目标路径</td></tr> <tr><td><strong>VOLUME</strong></td> <td><strong>容器数据卷，用于数据保存和持久化工作，用于容器运行时可以挂在到宿主机的目录</strong>&lt;br /&gt;语法：VOLUME [&quot;/data&quot;]</td></tr> <tr><td><strong>CMD</strong></td> <td><strong>指定一个容器启动时要运行的命令 Dockerfile 中可以有多个CMD指令，但只有最后一个生效，CMD 会被 docker run 之后的参数替换。</strong> RUN 是在build时运行，CMD 是在 dokcer run 时运行。注意 ENTRYPOINT 存在时，CMD 就是传参 CMD [&quot;参数1&quot;,&quot;参数2&quot;,...]&lt;br /&gt; 语法：两种格式 shell 和 exec：CMD &lt;命令&gt; 或 CMD [&quot;可执行文件&quot;,&quot;参数1&quot;,&quot;参数2&quot;,...]</td></tr> <tr><td><strong>ENTRYPOINT</strong></td> <td><strong>指定一个容器启动时要运行的命令 ENTRYPOINT 的目的和 CMD 一样，都是在指定容器启动程序及其参数。ENTRYPOINT可以和CMD一起用，一般是变参才会使用 CMD ，这里的 CMD 等于是在给 ENTRYPOINT 传参</strong>&lt;br /&gt; ENTRYPOINT 不会被 docker run 之后的参数替换。&lt;br /&gt;语法：ENTRYPOINT  [&quot;executable&quot;, &quot;param1&quot;, &quot;param2&quot;] 或者 ENTRYPOINT command param1 param2</td></tr></tbody></table> <p><strong>注意：</strong></p> <ul><li><p>CMD</p> <p>理解：Dockerfile中可以有多个CMD指令，但只有最后一个生效，CMD会被docker run之后的参数替换。</p> <p>比如 tomcat 镜像的 DockerFile 最后部分如下：</p> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token instruction"><span class="token keyword">EXPOSE</span> 8080</span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">&quot;catalina.sh&quot;</span>, <span class="token string">&quot;run&quot;</span>]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>正常运行命令：**docker run -it -p 8080:8080 镜像id  **，但是如果加参数运行命令：<strong>docker run -it -p 8080:8080 镜像id  /bin/bash</strong></p> <p>那么  <strong>CMD [&quot;catalina.sh&quot;, &quot;run&quot;]</strong>  会被 **/bin/bash **替换，相当于加了如下代码：</p> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token instruction"><span class="token keyword">EXPOSE</span> 8080</span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">&quot;catalina.sh&quot;</span>, <span class="token string">&quot;run&quot;</span>]</span>
<span class="token comment"># 加了如下代码，也就应证了，Dockerfile 中可以有多个CMD指令，但只有最后一个生效</span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">&quot;/bin/bash&quot;</span>, <span class="token string">&quot;run&quot;</span>]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>ENTRYPOINT</p> <p><img src="/static/images/docker/1711024229960.jpg" alt="1711024229960"></p> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token instruction"><span class="token keyword">ENTRYPOINT</span> [<span class="token string">&quot;nginx&quot;</span>,<span class="token string">&quot;-c&quot;</span>] # 定参</span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">&quot;/etc/nginx/nginx.conf&quot;</span>] # 变参</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ul> <table><thead><tr><th>是否传参</th> <th>按照dockerfile编写执行</th> <th>传参运行</th></tr></thead> <tbody><tr><td>Docker命令</td> <td>docker run nginx:test</td> <td>docker run nginx:test -c /etc/nginx/new.conf</td></tr> <tr><td>衍生出的实际命令</td> <td>nginx -c /etc/nginx/nginx.conf</td> <td>nginx -c /etc/nginx/new.conf</td></tr></tbody></table> <p>docker run nginx:test -c /etc/nginx/new.conf  运行后变为如下代码：</p> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token instruction"><span class="token keyword">ENTRYPOINT</span> [<span class="token string">&quot;nginx&quot;</span>,<span class="token string">&quot;-c&quot;</span>] # 定参</span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">&quot;/etc/nginx/nginx.conf&quot;</span>] # 变参</span>
<span class="token comment"># 增加以下代码（CMD 会被docker run 之后的参数替换）</span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">&quot;/etc/nginx/new.conf&quot;</span>] # 变参</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>那么原来 nginx -c /etc/nginx/nginx.conf 就变为 nginx -c /etc/nginx/new.conf</p> <h2 id="dockerfile-部署-springboot-项目到docker"><a href="#dockerfile-部署-springboot-项目到docker" class="header-anchor">#</a> Dockerfile 部署 springboot 项目到docker</h2> <ol><li>编译 jar 包</li> <li>编写 Dockerfile</li> <li></li></ol> <h2 id="docker-转移所有环境到-新服务器"><a href="#docker-转移所有环境到-新服务器" class="header-anchor">#</a> Docker 转移所有环境到 新服务器</h2> <ol><li><p>查看所有容器</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> <span class="token function">ps</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>查看所有镜像</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> images
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>将需要转移的容器保存为镜像</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 参考之前指令</span>
<span class="token function">docker</span> commit 容器名或id 新镜像名
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>将已有镜像保存为 tar 文件，使用docker save 命令</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 方式一</span>
<span class="token function">docker</span> save <span class="token parameter variable">-o</span> 文件名.tar 新镜像
<span class="token comment"># 方式二</span>
<span class="token function">docker</span> save 新镜像 <span class="token operator">&gt;</span> 文件名.tar 
<span class="token comment"># 多个</span>
<span class="token function">docker</span> save 新镜像1 新镜像2 <span class="token operator">&gt;</span> 文件名.tar
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>保存成功（没有提示），<code>ls</code> 命令查看是否生成 tar 文件</p></li> <li><p>将 tar 文件转到新的服务器上（使用Termius（Mac）、WinScp（Window）等工具）</p></li> <li><p>执行命令加载 tar 包和运行镜像</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> load <span class="token operator">&lt;</span> xxx.tar
<span class="token comment"># 或</span>
<span class="token function">docker</span> load <span class="token parameter variable">-i</span> xxx.tar
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ol></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/yfhu-blog/record/nginx/" class="prev">
        Nginx
      </a></span> <span class="next"><a href="/yfhu-blog/record/vuepress/">
        开始
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/yfhu-blog/assets/js/app.cc026d7f.js" defer></script><script src="/yfhu-blog/assets/js/2.c664984a.js" defer></script><script src="/yfhu-blog/assets/js/1.e3116851.js" defer></script><script src="/yfhu-blog/assets/js/57.c914399e.js" defer></script>
  </body>
</html>
